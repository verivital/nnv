function dx = spiral_non(x,u)
% Neural ODE from example
% Parameters of neural ode (10 neurons)
w1 = [0.2911133 ,  0.12008807;
       -0.24582624,  0.23181419;
       -0.25797904,  0.21687193;
       -0.19282854, -0.2602416 ;
        0.26780415, -0.20697702;
        0.23462369,  0.2294843 ;
       -0.2583547 ,  0.21444395;
       -0.04514714,  0.29514763;
       -0.15318371, -0.275755  ;
       0.24873598,  0.21018365];
b1 = [0.0038677 , -0.00026365, -0.007168970,  0.02469357,  0.01338706,...
        0.00856025, -0.00888401,  0.00516089, -0.00634514, -0.01914518]';
% Layer 2
w2 = [-0.58693904, -0.814841  , -0.8175157 ,  0.97060364,  0.6908913 ,...
        -0.92446184, -0.79249185, -1.1507587 ,  1.2072723 , -0.7983982 ;
       1.1564877 , -0.8991244 , -1.0774536 , -0.6731967 ,  1.0154784 ,...
         0.8984464 , -1.0766245 , -0.238209  , -0.5233613 ,  0.8886671];
b2 = [-0.04129209, -0.01508532]';

% Function
% u = x.^3;
u = x;
% dx = tanh(w1*u+b1); %layer 1
dx = w2*tanh(w1*u+b1)+b2; % Full dynamics in one line

end

